# Программирование на R

### Работа с пакетами

```r
sessionInfo()                                         # Информация о сессии
install.packages("ggplot2")                           # Установка пакета
library(ggplot2)                                      # Подключение пакета
demo(error.catching, package = "base", ask = TRUE)    # Запуск демонстрационного скрипта
vignette()
```

### Помощь

```r
ls(pos = "package:ggplot2")                          # Список объектов в пакете
ls                                                   # Вывод информации об функции и его код
?ls                                                  # Помощь по функции
find("mean")                                         # Поиск функции
example(ls)                                          # Примеры использования функции
```

## Особенности R

- Интерпретируемый и динамический язык программирования
- Основой является S и C
- Расширяемый с помощью пакетов на C, C++, Fortran
- Поддерживает множество графиков
- Имеет интерактивную документацию

## Основа синтаксиса R

- Язык регистрозависимый
- Признаком завершения команды является символ `;` или новая строка
- Для начала и окончания блока кода используются фигурные скобки `{ }`

## Языковые лексемы

- Пробельные символы
- Комментарии
    - Однострочные `#`
- Идентификаторы
    - Состоящие из букв, цифр и символов `_` и `.`
    - Например: `x`, `x1`, `x.y`, `x_y`
- Ключевые слова
    - `if`, `else`, `repeat`, `while`, `function`, `for`, `in`, `next`, `break`
    - `TRUE`, `FALSE`
    - `NULL`, `Inf`, `NaN`, `NA`
    - `NA_integer_`, `NA_real_`, `NA_complex_`, `NA_character_`
- Литералы
    - Числовые. Например: `1`, `1L`, `1.0`, `1.0e-1`, `1.0e+1`, `1.0e1`
    - Строковые. Например: `"abc"`, `'abc'`
    - Логические. Например: `TRUE`, `FALSE`
    - Прочие. Например: `5L`, `4-1i`
- Операции и пунктуация
    - Блок кода `{ }`
    - Индексация `[]`
    - Доступ к членам объекта `.`
    - Разделитель аргументов `,`
    - Последовательность `:`
    - Окончание команды `;`
    - Арифметические операции `+`, `-`, `*`, `/`, `^`, `%%`, `%/%`
    - Логические операции `!`, `&`, `|`, `&&`, `||`
    - Операции сравнения `==`, `!=`, `<`, `<=`, `>`, `>=`
    - Операции присваивания `<-`, `=`, `->`, `->>`, `<<-`
    - Операторы пакетов `%whatever%`. Например: `%in%`, `%*%`, `%x%`, `%o%`

## Система типов

- Что угодно в R является объектом
- Внутренний тип устанавливается автоматически R. Его можно узнать через функцию `typeof()`
- Распространённые команды для управления объектами:
    - `objects(name, pos = -1L, envir = as.environment(pos), all.names = FALSE, pattern, sorted = TRUE)` - список
      объектов в памяти
    - `rm(..., list = character(), pos = -1, envir = as.environment(pos), inherits = FALSE)` - удаление объектов
    - `exists(..., envir = parent.frame(), mode = "any", inherits = TRUE)` - проверка существования объекта
    - `get(..., envir = parent.frame(), mode = "any", inherits = TRUE)` - получение объекта
    - `assign(..., envir = parent.frame(), inherits = TRUE)` - присваивание объекта
- Пользовательские типы данных:
    - Векторы `vector(mode = "logical", length = 0L)`
    - Списки `list(...)`
    - Матрицы `matrix(data = NA, nrow = 1, ncol = 1, byrow = FALSE, dimnames = NULL)`
    - Массивы `array(data = NA, dim = 1L, dimnames = NULL)`
    - Факторы `factor(x, levels = NULL, labels = NULL, exclude = NULL, ordered = FALSE)`
    - Датафреймы `data.frame(...)`

# Векторы

Вектор - это одномерный набор однотипных данных.

Создание вектора:

```r
v <- 1:8
v <- c(4, 7, v)
v <- scan()               # Создание вектора их значений введённых с клавиатуры
v <- numeric(10)          # Создание вектора из 10 элементов типа numeric
v <- seq(1, 7, by = 2)    # Создание вектора из чисел от 1 до 7 с шагом 2
v <- rep(1:3, times = 2)  # Создание вектора из 2 повторений чисел от 1 до 3
```

Работа с вектором:

```r
v[1]                      # Получение первого элемента вектора
v[70] <- 5                # Добавление элемента с индексом 70 в вектор
v[3:5]                    # Получение элементов с 3 по 5
v[c(1, 3)]                # Получение элементов с индексом 1 и 3
v[-c(1, 3)]               # Получение всех элементов кроме элементов с индексом 1 и 3
v[v %% 2 == 0]            # Получение всех чётных элементов вектора
```

Функции для работы с векторами:

```r
sort(v)                   # Сортировка вектора
length(v)                 # Длина вектора
rev(v)                    # Реверс вектора
min(v)                    # Минимальное значение вектора
max(v)                    # Максимальное значение вектора
sum(v)                    # Сумма элементов вектора
mean(v)                   # Среднее значение элементов вектора

which(v > 5)              # Индексы элементов вектора, которые больше 5
which.max(v)              # Индекс максимального элемента вектора

union(v, 1:5)             # Объединение векторов
intersect(v, 1:2)         # Пересечение векторов
setdiff(v, 1:2)           # Разность векторов

rank(v)                   # Ранг элементов вектора
order(v)                  # Индексы элементов вектора, отсортированных по возрастанию
```

## Матрицы

Матрица - это двумерный набор однотипных данных.

Создание матрицы:

```r
m <- 1:6
dim(m) <- c(2, 3)                                   # Указание размерности матрицы

m <- matrix(1:6, nrow = 2, ncol = 3, byrow = TRUE)  # Создание матрицы из 6 элементов размерностью 2 на 3
```

Работа с матрицей:

```r
rowSums(m)                                          # Сумма элементов по строкам
rowMeans(m)                                         # Среднее значение элементов по строкам
colSums(m)                                          # Сумма элементов по столбцам
colMeans(m)                                         # Среднее значение элементов по столбцам

det(m)                                              # Определитель матрицы
ginv(m)                                             # Обратная матрица
cbind(m, 1:2)                                       # Добавление столбца в матрицу
rbind(m, 1:3)                                       # Добавление строки в матрицу
m %*% matrix(1:6, nrow = 3, ncol = 2)               # Умножение матрицы на вектор
```

## Массивы

Массив - это многомерный набор однотипных данных.

Создание массива:

```r
a <- 1:12
dim(a) <- c(2, 3, 2)                                # Указание размерности массива

a <- array(1:24, dim = c(2, 3, 4))                  # Создание массива из 24 элементов размерностью 2 на 3 на 4
```

## Факторы

Фактор (иначе признак) - это набор категориальных данных.

Создание фактора:

```r
f <- c(0, 20, 0, 20, 30, 0, 30)
f <- factor(f)                                      # Создание фактора из вектора

f <- factor(c("a", "b", "a", "b", "c", "a", "c"))   # Создание фактора из вектора строк

levels(f)                                           # Получение уровней фактора
levels(f) <- c(1, 2, 3)                             # Установка уровней фактора
```

## Списки

Список - это набор элементов разных типов.

Создание списка:

```r
l <- list(1, "a", 1:3, matrix(1:6, nrow = 2, ncol = 3)) # Создание списка из 4 элементов
l <- list(a = 1, b = "a", c = 1:3, d = c(1, 2, 3))      # Создание списка из именованных векторов
```

Получение доступа к элементам списка:

```r
l[[1]]                                              # Получение первого элемента списка
l$a                                                 # Получение элемента списка по имени
```

## Датафреймы

Данные в датафрейме представлены в виде таблицы, где строки - это наблюдения, а столбцы - это переменные.

Создание датафрейма:

```r
d <- data.frame(
  name = c("John", "Mary", "Peter"),
  age = c(18, 27, 24)
)                                                   # Создание датафрейма из векторов
d <- read.table("data.txt", header = TRUE)          # Создание датафрейма из файла
```

Работа с датафреймом:

```r
d[1, 1]                                             # Получение элемента датафрейма
d[age > 20, ]                                       # Получение строк датафрейма, где значение переменной age больше 20

attach(d)                                           # Прикрепление датафрейма к среде
summary(d)                                          # Получение статистической информации по датафрейму
```